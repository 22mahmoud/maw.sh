{# djlint:off H006,H021 #}
{% load django_vite static wagtail_cache wagtailuserbar %}

<!DOCTYPE html>
<html lang="en" class="ht-full scroll-smooth no-js">
  {% if not request.htmx %}

    <head>
      {# Basic meta #}
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1">

      {# HTMX config #}
      <meta name="htmx-config"
            content='{"inlineStyleNonce":"{{ CSP_NONCE }}","inlineScriptNonce":"{{ CSP_NONCE }}","includeIndicatorStyles":false,"allowEval":false}'>

      {# Fediverse #}
      <meta name="fediverse:creator" content="@22mahmoud@fosstodon.org" />

      {# Webmentions #}
      <link rel="webmention"
            href="https://webmention.io/mahmoudashraf.dev/webmention" />
      <link rel="pingback" href="https://webmention.io/mahmoudashraf.dev/xmlrpc" />

      {# Feeds #}
      <link rel="alternate"
            type="application/atom+xml"
            title="Mahmoud Ashraf » Blog"
            href="https://mahmoudashraf.dev/rss/blog/">
      <link rel="alternate"
            type="application/atom+xml"
            title="Mahmoud Ashraf » Feed"
            href="https://mahmoudashraf.dev/rss/feed/">

      {# Resource hints #}
      <link rel="dns-prefetch" href="//static.mahmoudashraf.dev">
      <link rel="preconnect" href="https://static.mahmoudashraf.dev" crossorigin>

      {# Preloads #}
      <link rel="preload" as="image" href="{% static 'icons/fill.png' %}">
      <link rel="preload"
            href="{% static 'fonts/outfit-v14-latin-700.woff2' %}"
            as="font"
            type="font/woff2"
            crossorigin>
      <link rel="preload"
            href="{% static 'fonts/figtree-v8-latin-regular.woff2' %}"
            as="font"
            type="font/woff2"
            crossorigin>
      <link rel="preload"
            href="{% static 'fonts/figtree-v8-latin-600.woff2' %}"
            as="font"
            type="font/woff2"
            crossorigin>

      {% if not page %}
        <title>
          {% block title %}
            Mahmoud Ashraf
          {% endblock title %}
        </title>
        <meta name="description"
              content="{% block description %}
                         Mahmoud Ashraf — Frontend Engineer from Alexandria, Egypt. I craft fast, accessible, and user-focused web experiences.
                       {% endblock description %}">
        <meta name="author"
              content="{% block author %}
                         Mahmoud Ashraf
                       {% endblock author %}">
      {% endif %}

      {# Keywords #}
      {% if page.keywords_content %}
        <meta name="keywords" content="{{ page.keywords_content }}">
      {% else %}
        <meta name="keywords" content="indieweb,front-end,linux,personal,blog">
      {% endif %}

      {# Canonical / author #}
      <link rel="author canonical self" href="https://mahmoudashraf.dev/">

      {# Favicons #}
      <link rel="icon"
            type="image/png"
            href="{% static "favicon-96x96.png" %}"
            sizes="96x96">
      <link rel="icon" type="image/svg+xml" href="{% static "favicon.svg" %}">
      <link rel="shortcut icon" href="{% static "favicon.ico" %}">
      <link rel="apple-touch-icon"
            sizes="180x180"
            href="{% static "apple-touch-icon.png" %}">
      <meta name="apple-mobile-web-app-title" content="Mahmoud Ashraf">
      <link rel="manifest" href="{% static "site.webmanifest" %}">

      {# Navigation #}
      {% if next_url %}
        <link rel="next" href="{{ next_url }}">
      {% endif %}
      {% if prev_url %}
        <link rel="prev" href="{{ prev_url }}">
      {% endif %}

      {# JavaScript / Styles #}
      <script nonce="{{ CSP_NONCE }}">document.documentElement.classList.remove('no-js');</script>
      <style nonce="{{ CSP_NONCE }}">
        [x-cloak] { display: none !important; }
        .no-js .js-only { display: none; }
        .js-only { visibility: visible; }
      </style>

      {% include "wagtailseo/meta.html" %}
      <link rel="shortlink"
            type="text/html"
            href="https://maw.sh{{ request.path }}">

      {% vite_hmr_client %}
      {% vite_asset 'src/resources/js/app.ts' nonce=CSP_NONCE %}

      {% block head %}
      {% endblock head %}
    </head>

  {% endif %}

  <body hx-headers='{"x-csrftoken": "{{ csrf_token }}"}'
        class="ht-full relative bg-darker text-primary">

    <aside class="fixed left-4 bottom-4 max-w-xs z-10 bg-darker">
      {% block aside %}
      {% endblock aside %}
    </aside>

    <div class="min-h-full flex flex-col max-w-6xl mx-auto">
      {% if not request.htmx %}
        {% wagtailuserbar %}
        <a id="top"></a>
        {% include "includes/messages.html" %}
        {% include "includes/header.html" %}
      {% endif %}

      <main class="bg-darker flex-1 flex flex-col relative z-1">
        {% block content %}
        {% endblock content %}
      </main>

      {% if not request.htmx %}
        {% include "includes/footer.html" %}

        {% include "wagtailseo/struct_data.html" %}

        <script defer
                data-api="/api/event"
                data-domain="mahmoudashraf.dev"
                src="/js/script.js"></script>
      {% endif %}
    </div>
  </body>
</html>
