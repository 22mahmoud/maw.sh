{% extends "base.html" %}
{% load i18n allauth base_tags field_tags button_tags %}
{% load socialaccount %}

{% block title %}
  {% trans "Sign Up | Mahmoud Ashraf" %}
{% endblock title %}

{% block content %}
  <div class="flex-1 w-full bg-dark px-4 py-8 sm:py-12 md:py-16 zigzag">
    <div class="max-w-xl mx-auto px-6 py-8 sm:px-8 sm:py-10 space-y-6 text-primary">

      <h2 class="text-2xl font-semibold">
        {% trans "Sign Up" %}
      </h2>

      <p class="text-primary/80">
        {% blocktranslate %}
          Already have an account? Then please
          <a href="{{ login_url }}" class="text-accent underline hover:text-accent-bright">
            sign in
          </a>.
        {% endblocktranslate %}
      </p>

      {% if not SOCIALACCOUNT_ONLY %}
        <div>
          <form method="post"
                id="signup-form"
                action="{% url 'account_signup' %}"
                hx-post="{% url 'account_signup' %}"
                hx-select="#signup-form"
                hx-swap="outerHTML"
                class="flex flex-col gap-5">
            {% csrf_token %}
            {{ redirect_field }}

            {% for field in form %}
              {% with attrs=field.field.widget.attrs %}
                {% field
                  name=field.name
                  label=field.label
                  help_text=field.help_text
                  value=field.value
                  error=field.errors
                  error_message=field.errors.as_text
                  disabled=field.field.disabled
                  required=field.field.required
                  type=field.field.widget.input_type
                  id=field.id_for_label
                  readonly=attrs.readonly|default_if_none:False
                  checked=attrs.checked|default_if_none:False
                  autocomplete=attrs.autocomplete|default:""
                  placeholder=attrs.placeholder|default:""
                  rows=attrs.rows|default_if_none:""
                  as=field.field.widget.input_type|default_if_none:"input"
                  %}
                {% endfield %}
              {% endwith %}
            {% endfor %}
            <div>
              {% button type="submit" variant="primary" %}
                {% trans "Sign Up" %}
                {% icon 'circle-notch' id="spinner" class="htmx-indicator animate-spin h-5 w-5" %}
              {% endbutton %}
            </div>
          </form>
        </div>
      {% endif %}

      {% if SOCIALACCOUNT_ENABLED %}
        {% include "socialaccount/snippets/login.html" %}
      {% endif %}
    </div>
  </div>
{% endblock content %}
