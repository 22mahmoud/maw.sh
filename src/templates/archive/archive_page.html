{% extends "base.html" %}
{% load button_tags link_tags wagtailcore_tags %}

{% block content %}
  <div class="grow w-full bg-dark px-4 py-6 md:py-10 zigzag">
    <header class="max-w-3xl mx-auto mb-10 text-center">
      <h2 class="font-heading text-3xl sm:text-4xl md:text-5xl font-bold text-primary">
        {{ page.title|default:"Archive" }}
      </h2>

      {% if page.introduction %}
        <p class="mt-4 text-base sm:text-lg text-secondary max-w-prose mx-auto">
          {{ page.introduction }}
        </p>
      {% endif %}

      {% if type == 'search' %}
        <div class="mt-8">
          <form action="{% url 'search' %}"
                method="get"
                class="flex flex-col sm:flex-row gap-3 max-w-md mx-auto items-stretch sm:items-center">
            <div class="flex-grow">
              {{ search_form }}
            </div>
            {% button type="submit" variant="outline" class="w-fit sm:w-auto" %}
              Search
            {% endbutton %}
          </form>
        </div>
      {% endif %}
    </header>

    {% if posts %}
      <ul class="h-feed flex flex-col gap-10 md:gap-12">
        {% for post in posts %}
          <li>
            {% for block in post.body %}
              <article class="h-entry mx-auto max-w-3xl shadow bg-gradient-to-b from-gradient-1 to-gradient-2 ps-[2px]">
                <div class="flex flex-col py-2 px-4 bg-darker gap-2">
                  {% include "includes/feed_post_header.html" with post=post %}
                  {% include_block block with layout="preview" %}
                </div>
              </article>
            {% endfor %}
          </li>
        {% endfor %}
      </ul>

      <div class="max-w-3xl mx-auto mt-12">
        {% include "includes/pagination.html" with page=posts %}
      </div>
    {% else %}
      <div class="text-center text-secondary mt-10">
        <p class="text-lg">
          {{ empty_state_message|default:"No posts available." }}
        </p>
      </div>
    {% endif %}
  </div>
{% endblock content %}
