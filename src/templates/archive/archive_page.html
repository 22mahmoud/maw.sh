{% extends "base.html" %}
{% load wagtailimages_tags wagtailroutablepage_tags wagtailcore_tags %}

{% block content %}
  <div class="w-full h-full bg-dark p-4 zigzag">
    <header class="max-w-2xl mx-auto mb-8">
      <h2 class="font-heading text-3xl md:text-4xl font-bold text-primary">
        {{ archive_title|default:"Archive" }}
      </h2>
      {% if archive_description %}
        <p class="mt-2 text-base text-secondary max-w-prose mx-auto">
          {{ archive_description }}
        </p>
      {% endif %}
    </header>

    <ul class="h-feed flex flex-col gap-8">
      {% for post in posts %}
        <li>
          {% for block in post.body %}
            <article class="h-entry mx-auto max-w-2xl shadow bg-gradient-to-b from-gradient-1 to-gradient-2 ps-[2px]">
              <div class="flex flex-col py-2 px-4 bg-darker gap-2">
                <header class="flex items-center gap-1">
                  <div class="flex">
                    {% for author in post.authors %}
                      <a class="h-card w-8 h-8 rounded-full first:ml-0 border-2 border-solid border-darker -ml-4
                                {% if post.authors|length > 1 %}
                                  transform transition-transform duration-200 hover:scale-110 hover:z-10
                                {% endif %}"
                         href="{% routablepageurl post.get_parent.specific 'posts_by_author' author.slug %}">
                        {% picture author.image format-{avif,webp,jpeg} width-200 alt=author.full_name class="u-photo w-full h-full object-cover rounded-full" %}
                      </a>
                    {% endfor %}
                  </div>

                  <a class="u-url text-sm text-secondary" href="{% pageurl post %}">
                    <time class="dt-published"
                          datetime="{{ post.first_published_at|date:'c' }}">
                      {{ post.first_published_at|date:"F j, Y \\a\\t g:i A" }}
                    </time>
                  </a>
                </header>

                {% include_block block with is_preview=True %}
              </div>
            </article>
          {% endfor %}
        </li>
      {% endfor %}
    </ul>

    <div class="max-w-2xl mx-auto mt-8">
      {% include "includes/pagination.html" with page=posts %}
    </div>
  </div>
{% endblock content %}
