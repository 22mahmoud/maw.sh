{% load base_tags field_tags button_tags menu_tags %}
{% load wagtailcore_tags %}

<header x-data="{ open: false }"
        class="sticky z-100 top-0 shadow bg-gradient-to-r from-gradient-1 to-gradient-2 font-bold pb-[2px]">
  <div class="h-full w-full bg-dark px-2 py-3 flex flex-wrap items-center justify-between gap-4">
    <a href="{% slugurl 'home' %}"
       class="text-2xl font-bold whitespace-nowrap">
      <h1>
        ~/mahmoud_ashraf
      </h1>
    </a>

    <button @click="open = !open"
            x-clock
            class="sm:hidden inline-flex items-center justify-center p-2 rounded-md text-primary hover:text-white focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white"
            :aria-expanded="open.toString()"
            aria-controls="mobile-menu"
            aria-label="Toggle navigation menu">
      {% icon "hamburger" x_show="!open" class="h-6 w-6" aria_hidden="true" %}
      {% icon "x" x_show="open" class="h-6 w-6" aria_hidden="true" %}
    </button>

    <div class="hidden sm:flex items-center gap-4" x-clock>
      <form action="{% url "search" %}"
            method="get"
            class="w-full sm:w-auto flex items-stretch gap-2">
        {% field name="q" required="" type="search" placeholder="Search..." class="h-[42px] max-w-xs text-base" aria_label="Search" %}
        {% button type="submit" variant="muted" size="sm" class="h-[42px] px-4" %}
          {% icon "magnifying-glass" class="w-5 h-5" %}
          <span class="sr-only">Search</span>
        {% endbutton %}
      </form>

      <nav>
        <ul class="flex flex-wrap justify-start sm:justify-end gap-4 text-base sm:text-lg">
          {% main_menu template="includes/main_menu.html" %}
        </ul>
      </nav>
    </div>
  </div>

  <div x-collapse
       x-cloak
       x-show="open"
       x-transition:enter="transition ease-out duration-300"
       x-transition:enter-start="opacity-0 -translate-y-2"
       x-transition:enter-end="opacity-100 translate-y-0"
       x-transition:leave="transition ease-in duration-200"
       x-transition:leave-start="opacity-100 translate-y-0"
       x-transition:leave-end="opacity-0 -translate-y-2"
       class="sm:hidden bg-dark px-4 pt-4 pb-6 overflow-hidden transform-gpu">
    <form action="{% url "search" %}"
          method="get"
          class="w-full flex items-stretch gap-2 mb-4">
      {% field name="q" required="" type="search" placeholder="Search..." class="h-[42px] w-full text-base" aria_label="Search" %}
      {% button type="submit" variant="muted" size="sm" class="h-[42px] px-4" %}
        {% icon "magnifying-glass" class="w-5 h-5" %}
        <span class="sr-only">Search</span>
      {% endbutton %}
    </form>

    <nav>
      <ul class="flex flex-col gap-2 text-base">
        {% main_menu template="includes/main_menu.html" %}
      </ul>
    </nav>
  </div>
</header>
