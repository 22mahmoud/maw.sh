{% load base_tags %}

{% if tag_type == 'checkbox' %}
  <div class="flex items-center gap-2">
    <input type="checkbox" name="{{ name }}" {{ field_attrs }}>

    {% if label_text %}
      <label for="{{ id }}" class="{{ label_class }}">
        {{ label_text }}
      </label>
    {% endif %}
  </div>
{% elif tag_type == 'radio' %}
  <div class="flex-1 flex flex-col gap-1.5">
    {% if label_text %}
      <p class="{{ label_class }}">
        {{ label_text }}
      </p>
    {% endif %}

    <div class="flex flex-col gap-2">
      {{ options_html|safe }}
    </div>

    <p id="{{ error_id }}"
       class="text-sm text-red-400 mt-1
              {% if not error_message %}
                sr-only
              {% endif %}"
       role="alert">
      {{ error_message|default:"" }}
    </p>
  </div>
{% else %}
  <div class="flex-1 flex flex-col gap-1.5">
    {% if label_text %}
      <label for="{{ id }}" class="{{ label_class }}">
        {{ label_text }}
      </label>
    {% endif %}

    {% if help_text %}
      <div class="prose prose-sm prose-main text-sm text-secondary">
        {{ help_text }}
      </div>
    {% endif %}

    {% if tag_type == 'select' %}
      <select {{ field_attrs }}>
        {{ options_html|safe }}
      </select>
    {% elif tag_type == "textarea" %}
      <textarea {{ field_attrs }}>{{ value }}</textarea>
    {% else %}
      {% if type == "password" %}
        <div x-data="passwordField" class="relative">
          <input :type="inputType" {{ field_attrs }} class="pr-12">
          <button type="button"
                  @click="toggle"
                  :aria-label="toggleLabel"
                  class="js-only absolute inset-y-0 right-0 flex items-center px-3 text-secondary transition-colors duration-200 hover:text-primary focus:outline-none focus-visible:ring-2 focus-visible:ring-primary/50">
            <span x-show="isHidden" x-cloak>
              {% icon "eye" class="w-5 h-5" %}
            </span>
            <span x-show="isVisible" x-cloak>
              {% icon "eye-slash" class="w-5 h-5" %}
            </span>
          </button>
        </div>

      {% else %}
        <input {{ field_attrs }}>
      {% endif %}
    {% endif %}

    <p id="{{ error_id }}"
       class="text-sm text-red-400 mt-1
              {% if not error_message %}
                sr-only
              {% endif %}"
       role="alert">
      {{ error_message|default:"" }}
    </p>
  </div>
{% endif %}
