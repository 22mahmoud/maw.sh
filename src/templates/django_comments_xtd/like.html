{% extends "base.html" %}
{% load i18n %}
{% load comments_xtd %}
{% load button_tags %}

{% block title %}
  {% trans "Confirm your opinion" %}
{% endblock title %}

{% block content %}
  <div class="grow flex zigzag bg-dark pt-6">
    <article class="grow flex flex-col mx-auto max-w-3xl gap-6 py-4 px-4 sm:px-6">
      <header class="prose prose-main text-center space-y-2">
        <h1 class="text-xl font-semibold text-primary">
          {% if already_liked_it %}
            {% trans "You liked this comment, do you want to change it?" %}
          {% else %}
            {% trans "Do you like this comment?" %}
          {% endif %}
        </h1>
        <p class="text-secondary">
          {% trans "Please, confirm your opinion about the comment." %}
        </p>
      </header>

      <section class="flex gap-3 sm:gap-4">
        <div class="flex-1 flex gap-4">
          <div class="flex-shrink-0">
            <div class="w-10 h-10 rounded-full overflow-hidden ring-2 ring-transparent group-hover:ring-accent transition-all duration-200">
              {{ form.cleaned_data.email|xtd_comment_gravatar }}
            </div>
          </div>

          <div class="flex-1 rounded-xl bg-darker/90 p-4">
            <div class="flex justify-between items-center text-sm mb-2">
              <span class="font-medium text-primary">
                {% if comment.user_url %}
                  <a href="{{ comment.user_url }}"
                     target="_blank"
                     class="hover:text-accent transition-colors duration-200">
                    {{ comment.user_name }}
                  </a>
                {% else %}
                  {{ comment.user_name }}
                {% endif %}
              </span>
              <time datetime="{{ comment.submit_date|date:"c" }}"
                    class="text-xs text-secondary/80">
                {{ comment.submit_date|date:"M j, Y Â· H:i" }}
              </time>
            </div>
            <div class="prose prose-main prose-sm max-w-none text-primary/90 mb-3 leading-relaxed">
              {{ comment.comment|linebreaks }}
            </div>
          </div>
        </div>
      </section>

      {% with object_absolute_url=comment.content_object.get_absolute_url %}
        {% if object_absolute_url %}
          <p class="text-center text-secondary">
            {% trans "Posted to" %} <a href="{{ object_absolute_url }}" class="text-accent hover:underline">{{ comment.content_object }}</a>
          </p>
        {% endif %}
      {% endwith %}

      {% if already_liked_it %}
        <div class="text-center text-warning bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-300 dark:border-yellow-800 rounded-lg p-4 text-sm">
          {% trans "Click on the 'withdraw' button if you want to withdraw your positive opinion on this comment." %}
        </div>
      {% endif %}

      <section class="flex justify-center pt-2">
        <form method="post" class="flex flex-row items-center gap-8">
          {% csrf_token %}

          <input type="hidden" name="next" value="{{ comment.get_absolute_url }}">

          {% if already_liked_it %}
            {% button variant="outline" size="md" as="input" type="submit" value=_("Withdraw") %}
            {% endbutton %}
          {% else %}
            {% button variant="primary" size="md" as="input" type="submit" value=_("I like it") %}
            {% endbutton %}
          {% endif %}

          {% button href=comment.get_absolute_url variant="secondary" size="md" %}
            {% trans "Cancel" %}
          {% endbutton %}
        </form>
      </section>
    </article>
  </div>
{% endblock content %}
